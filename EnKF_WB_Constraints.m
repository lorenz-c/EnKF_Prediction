function [WB_var, G] = EnKF_WB_Constraints(settings)

if strcmp(settings.constraints.method, 'data')

    WB_var = EnKF_Prepare_Data(settings.constraints.data, ...
                      [], ...
                      settings.constraints.varnme, ...
                      settings.id_var, ...
                      settings.region_ids, ...
                      settings.obscov.sdte_back, ...
                      settings.obscov.edte_back, ...
                      settings.constraints.remsc, ...
                      settings.constraints.filter, ...
                      settings.constraints.ssnl);
   
   if settings.constraints.ssnl == true
       WB_var = repmat(WB_var, settings.nr_yrs, 1, 1);
   end

elseif strcmp(settings.constraints.method, 'percentage')
    
    WB_var = EnKF_Prepare_Data(settings.constraints.data, ...
                      [], ...
                      settings.constraints.varnme, ...
                      settings.id_var, ...
                      settings.region_ids, ...
                      settings.obscov.sdte_back, ...
                      settings.obscov.edte_back, ...
                      settings.constraints.remsc, ...
                      settings.constraints.filter, ...
                      settings.constraints.ssnl);
                  
    WB_var = (WB_var*settings.constraints.value).^2;
    
    if settings.constraints.ssnl == true
       WB_var = repmat(WB_var, settings.nr_yrs, 1, 1);
    end
    
elseif strcmp(settings.constraints.method, 'constant')
    
    if length(settings.constraints.value) == 1
        WB_var = ones(settings.nr_regions, 1) * settings.constraints.value;
    else
        WB_var = settings.constraints.value;
    end
    
    WB_var = repmat(WB_var, settings.nts, 1, 1);
    
    
end

I = eye(settings.nr_regions, settings.nr_regions);

    
% Matrix which is needed for the constraints; this matrix simply computes 
% the water budget through P - E - R - DM
G = [I -I -I -I];